<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login | Smart Hire</title>
    <link rel="stylesheet" href="/css/login.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>

<div class="dark-mode-toggle-container">
    <span class="toggle-label">Theme:</span>
    <button class="dark-toggle" aria-label="Toggle dark mode">Dark Mode</button>
</div>

<div class="login-container" data-sr>
    <div class="login-card">
        <h1 class="title">Welcome Back</h1>
        <p class="subtitle">Log in to <span class="brand">Smart Hire</span></p>

        <form class="login-form" id="login-form">
            <div class="form-group">
                <i class="fas fa-envelope"></i>
                <input type="email" id="login-email" placeholder="Email Address" required />
            </div>

            <div class="form-group">
                <i class="fas fa-lock"></i>
                <input type="password" id="login-password" placeholder="Password" required />
            </div>

            <div class="form-options">
                <label>
                    <input type="checkbox" /> Remember Me
                </label>
                <a href="#">Forgot Password?</a>
            </div>

            <button type="submit" class="btn-submit">Login</button>
            <p class="register-link">New to Smart Hire? <a href="register.html">Create an account</a></p>
        </form>
    </div>
</div>

<script>
// Set dark mode by default when the page loads
document.addEventListener('DOMContentLoaded', function() {
    // Check localStorage for saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-mode');
    } else {
        document.body.classList.remove('dark-mode');
    }

    // Dark Mode Toggle Logic
    const darkToggle = document.querySelector('.dark-toggle');
    darkToggle.addEventListener('click', function() {
        document.body.classList.toggle('dark-mode');

        // Save the user's theme preference to localStorage
        const currentTheme = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
        localStorage.setItem('theme', currentTheme);
    });
});

// Form submission handling
document.getElementById('login-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;

    try {
        const response = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
        });
        const text = await response.text();
        alert(text);

        if (text.includes('successful')) {
            localStorage.setItem('currentLoggedInUserEmail', email); // optional for dashboard
            window.location.href = 'dashboard.html';
        }
    } catch (err) {
        console.error(err);
        alert('Error logging in.');
    }
});
</script>

</body>
</html>
