<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Discover Freelancers | Smart Hire</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/styles.css" /> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="/css/freelancers_page.css" /> 
    <style>
        /* Add custom CSS for circular profile image with offset */
        .freelancer-profile-img {
            width: 60px;         /* Adjust the size of the profile picture */
            height: 60px;        /* Ensure it's a square */
            border-radius: 50%;  /* Makes the image circular */
            object-fit: cover;   /* Ensures the image covers the area without distortion */
            margin-right: 15px;  /* Space between image and text */
            margin-left: -10px;  /* Slight slide to the left for effect */
        }

        /* Flexbox layout for freelancer card */
        .freelancer-card {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .freelancer-info {
            display: flex;
            flex-direction: column;
        }

        .freelancer-info h3 {
            margin: 0;
            font-size: 18px;
            font-weight: bold;
        }

        .freelancer-info p {
            margin: 5px 0;
            font-size: 14px;
            color: #555;
        }

        .freelancer-info .highlight {
            color: #007bff;
            font-weight: bold;
        }

        .freelancer-rating {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .freelancer-rating span {
            font-size: 14px;
            margin-right: 10px;
        }

        /* Star Rating */
        .fa-star {
            color: grey; /* Default color for unfilled stars */
            cursor: pointer;
        }

        .fa-star.filled {
            color: yellow; /* Yellow color for filled stars */
        }

        /* Styling for dark mode */
        body.dark-mode {
            background-color: #121212;
            color: #f1f1f1;
        }
        .dark-mode a {
            color: #f1f1f1;
        }
    </style>
</head>

<!-- Default dark mode -->
<body class="dark-mode">

    <!-- Dark mode toggle script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const savedTheme = localStorage.getItem("theme");

            // If no theme saved, default to dark mode
            if (!savedTheme) {
                document.body.classList.add("dark-mode");
                localStorage.setItem("theme", "dark");
            } else {
                // Apply user's saved theme
                if (savedTheme === "dark") {
                    document.body.classList.add("dark-mode");
                } else {
                    document.body.classList.remove("dark-mode");
                }
            }

            // Toggle button behavior
            const toggleBtn = document.querySelector(".dark-toggle");
            if (toggleBtn) {
                toggleBtn.addEventListener("click", () => {
                    document.body.classList.toggle("dark-mode");
                    const updatedTheme = document.body.classList.contains("dark-mode") ? "dark" : "light";
                    localStorage.setItem("theme", updatedTheme);
                });
            }
        });
    </script>

    <div id="progress-bar"></div>

    <!-- Dark Mode Toggle -->
    <div class="dark-mode-toggle-container">
        <span class="toggle-label">Theme:</span>
        <button class="dark-toggle" aria-label="Toggle dark mode">Dark Mode</button>
    </div>

    <!-- Navbar -->
    <nav id="navbar">
        <a href="index.html">Home</a>
        <a href="freelancers.html" class="active">Discover</a>
        <a href="index.html#about">About</a>
        <a href="index.html#contact">Contact</a>
        <a href="index.html#testimonials">Testimonials</a>
        <a href="dashboard.html">Dashboard</a>
        <div class="auth-buttons">
            <button class="auth-button" onclick="window.location.href='login.html'">Login</button>
            <button class="auth-button" onclick="window.location.href='register.html'">Sign Up</button>
        </div>
    </nav>

    <!-- Page Content -->
    <div class="page-container">

        <section class="discovery-header">
            <h1 class="title">Find Your Expert</h1>
            <p class="subtitle">Search over 500+ verified local and remote professionals.</p>
        </section>

        <!-- Search Section -->
        <div class="search-section" data-sr>
            <input type="text" id="search-input" placeholder="Search by Name, Skill, or Service..." />
            <button onclick="filterFreelancers()"><i class="fas fa-search"></i> Search</button>
        </div>

        <!-- Freelancers Grid -->
        <div class="freelancers-grid" id="freelancers-grid"></div>

        <!-- Pagination Controls -->
        <div class="pagination-controls">
            <button id="prev-btn" onclick="changePage(-1)" disabled>Previous</button>
            <span id="page-info">Page 1 of X</span>
            <button id="next-btn" onclick="changePage(1)">Next</button>
        </div>

    </div>

    <!-- Footer -->
    <footer>
        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
    </footer>

    <!-- Scroll Reveal and Custom Scripts -->
    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="/js/freelancers.js"></script>

    <script>
        let freelancersData = [];
        let currentPage = 1;
        const itemsPerPage = 6;

        // Function to fetch and display freelancers
        async function loadFreelancers() {
            try {
                const response = await fetch('/freelancers');
                freelancersData = await response.json();

                displayFreelancers();
            } catch (error) {
                console.error('Error fetching freelancers:', error);
            }
        }

	// Function to fetch and display freelancers
async function loadFreelancers() {
    try {
        // Fetch data from the backend /freelancers endpoint
        const response = await fetch('/freelancers');
        
        // Convert the response to JSON (the data sent from the backend)
        freelancersData = await response.json();

        // Once data is fetched, call the function to display freelancers
        displayFreelancers();
    } catch (error) {
        console.error('Error fetching freelancers:', error);
    }
}



            // Update pagination
            document.getElementById('page-info').textContent = `Page ${currentPage} of ${Math.ceil(freelancersData.length / itemsPerPage)}`;
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').disabled = currentPage === Math.ceil(freelancersData.length / itemsPerPage);
        }

        // Function to highlight specific skills (e.g., Web Development, Graphic Design)
        function highlightSkill(skill) {
            if (skill && (skill.includes("Web Development") || skill.includes("Graphic Design"))) {
                return "highlight";
            }
            return "";
        }

        // Generate star rating based on freelancer's rating
        function generateRatingStars(rating) {
            const totalStars = 5;
            let starsHtml = '';

            for (let i = 1; i <= totalStars; i++) {
                starsHtml += `<i class="fa fa-star ${i <= rating ? 'filled' : ''}"></i>`;
            }
            return starsHtml;
        }

        // Function to handle page changes
        function changePage(direction) {
            currentPage += direction;
            displayFreelancers();
        }

        // Search freelancers based on input
        function filterFreelancers() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const filteredFreelancers = freelancersData.filter(freelancer =>
                freelancer.name.toLowerCase().includes(searchTerm) ||
                (freelancer.skill && freelancer.skill.toLowerCase().includes(searchTerm))
            );
            freelancersData = filteredFreelancers;
            currentPage = 1; // Reset to page 1 on search
            displayFreelancers();
        }

        // Load freelancers when the page is ready
        document.addEventListener('DOMContentLoaded', loadFreelancers);
    </script>

</body>
</html>
